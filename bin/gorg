#!/usr/bin/env ruby

require "optparse"

$:.unshift(File.join(File.dirname(__FILE__), "..", "lib"))
require "gorg"

opts = {}
ARGV.options do |o|
  o.set_summary_indent("  ")
  o.banner = "Usage: gorg <dump|sink|load> [options]"
  o.on("-f", "--file=path", String, "Path to Doozer state file") { |p| opts[:path] = p }
  o.on("-q", "--quiet", "Suppress logs") { opts[:quiet] = true }
  o.on("-h", "--help", "Show this help message") { abort(o.to_s) }
  o.separator("")
  o.parse!
  action = ARGV.first

  abort(o.to_s) if !action

  Gorg.new(opts).send(action)
end
